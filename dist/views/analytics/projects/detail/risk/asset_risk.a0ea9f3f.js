!function(){"use strict";angular.module("kt.lode").controller("ktAssetRiskCtrl",["$scope","$location","$stateParams","ktProjectsService","ktProjectStaticsReportService","ktDateHelper",function(a,b,c,d,e,f){function g(){var b,f,g;g=a.radioPeriod,g=g.split("~"),b=g[0],f=g[1],d.get($.extend({projectID:c.projectID,subContent:"discretized_dimensions"},h),function(b){a.dimensions=b.dimensions,a.params.dimension=a.params.dimension||b.dimensions[0].key}),e.get($.extend({projectID:c.projectID,dimention:"risk",type:"asset",start_date:b,end_date:f},h),function(b){a.data=b,a.assetRiskChart.chartOptions=$.extend(!0,{},i,{legend:{data:_.map(b.trends,"name")},xAxis:{type:"category",data:b.dates},series:_.map(b.trends,function(a){return a.type="line",a})})})}var h=a.params=$.extend({dimension:null,risk_index:"ovd_rate"},b.search()||{});a.risk_indexs=[{name:"C-M1",value:"C-M1"},{name:"M1-C",value:"M1-C"},{name:"M1-M2",value:"M1-M2"},{name:"逾期率",value:"ovd_rate"},{name:"不良率",value:"np_rate"}],a.vintageRange=function(){if(h.vintage_start_date)return h.vintage_start_date+"~"+h.vintage_end_date}(),a.dimensions=[],f.initPeriod(a,h),a.data={},a.$watch("radioPeriod",function(a,c){if(a!==c&&"custom"!==a){var d=a.split("~");b.search($.extend(h,{start_date:d[0]||null,end_date:d[1]||null}))}}),a.goTo=function(a,c){var d={};d[a]=c,b.search($.extend(h,d))},a.assetRiskChart={radioDataShowType:"chart",chartOptions:{}},a.dimensionsActiveName=function(){var b=_.find(a.dimensions,function(b){return b.key===a.params.dimension})||a.dimensions[0];return b?b.name:""};var i={tooltip:{axisPointer:{type:"line"},yAxisFormat:"percent"}};a.risk_indexs.activeName=function(){var b=_.find(a.risk_indexs,function(a){return a.value===h.risk_index})||a.risk_indexs[0];return b.name},g()}])}();