!function(){"use strict";angular.module("kt.lode").controller("ktUserFeatureCtrl",["$scope","$location","$stateParams","ktProjectStaticsReportService","ktDateHelper",function(a,b,c,d,e){function f(b){var c,d,e={ageChart:["prncp_balns_by_age","loan_amnt_incrmnt_by_age"],educationChart:["prncp_balns_by_education","loan_amnt_incrmnt_by_education"]},f=e[b];return c="时点余额"===a[b].chartDimension?f[0]:f[1],d="absolute"===a[b].menuData.value?"":"_percent",j="_percent"===d?{tooltip:{yAxisFormat:"percent"},yAxis:{max:1,min:0}}:{tooltip:{yAxisFormat:"rmb"},yAxis:{max:null}},c+d}function g(b){var c=a.data,d=f(b);a[b].list=c[d],a[b].chartOptions=$.extend(!0,{},j,{legend:{data:_.map(c[d],"name")},xAxis:{type:"category",data:c.dates},series:_.map(c[d],function(a){return a.type="bar",a.stack="堆积组",a.barWidth=40,a})})}function h(){var b,e,f;f=a.radioPeriod,f=f.split("~"),b=f[0]||null,e=f[1],d.get($.extend({projectID:c.projectID,type:"borrower",dimention:"distribution",start_date:b,end_date:e},i),function(b){a.data=b,g("ageChart"),g("educationChart")})}a.$emit("activeProjectChange",{projectID:c.projectID});var i=b.search()||{};e.initPeriod(a,i),a.$watch("radioPeriod",function(a,c){if(a!==c&&"custom"!==a){var d=a.split("~");b.search($.extend(i,{start_date:d[0]||null,end_date:d[1]||null}))}}),a.ageChart={radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"}},a.educationChart={radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"}},a.$watch("ageChart.menuData.index",function(a,b){a!==b&&g("ageChart")}),a.$watch("ageChart.chartDimension",function(a,b){a!==b&&g("ageChart")}),a.$watch("educationChart.menuData.index",function(a,b){a!==b&&g("educationChart")}),a.$watch("educationChart.chartDimension",function(a,b){a!==b&&g("educationChart")});var j={};h()}])}();