!function(){"use strict";angular.module("kt.lode").controller("ktAssetFeatureCtrl",["$scope","$location","$stateParams","ktProjectStaticsReportService","ktDateHelper",function(a,b,c,d,e){function f(b){var c,d,e={timeLimitChart:["prncp_balns_by_term","loan_amnt_incrmnt_by_term"],amountChart:["prncp_balns_by_amnt","loan_amnt_incrmnt_by_amnt"],pledgeChart:["prncp_balns_by_mortgage_rate","loan_amnt_incrmnt_by_mortgage_rate"]},f=e[b];return c="时点余额"===a[b].chartDimension?f[0]:f[1],d="absolute"===a[b].menuData.value?"":"_percent",j="_percent"===d?{tooltip:{yAxisFormat:"percent"},yAxis:{interval:.2,max:1,min:0}}:{tooltip:{yAxisFormat:"rmb"},yAxis:{interval:null,max:null}},c+d}function g(b){var c=a.data,d=f(b);a[b].list=c[d],a[b].chartOptions=$.extend(!0,{},j,{legend:{data:_.map(c[d],"name")},xAxis:{type:"category",data:c.dates},series:_.map(c[d],function(a){return a.type="bar",a.stack="堆积组",a.barWidth=40,a})})}function h(){var b,e,f;f=a.radioPeriod,f=f.split("~"),b=f[0]||null,e=f[1],d.get($.extend({projectID:c.projectID,type:"loan",dimention:"distribution",start_date:b,end_date:e},i),function(b){a.data=b,g("pledgeChart"),g("timeLimitChart"),g("amountChart")})}a.$emit("activeProjectChange",{projectID:c.projectID});var i=b.search()||{};e.initPeriod(a,i),a.$watch("radioPeriod",function(a,c){if(a!==c&&"custom"!==a){var d=a.split("~");b.search($.extend(i,{start_date:d[0]||null,end_date:d[1]||null}))}}),a.pledgeChart={radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"}},a.timeLimitChart={radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"}},a.amountChart={radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"}},a.$watch("timeLimitChart.menuData.index",function(a,b){a!==b&&g("timeLimitChart")}),a.$watch("timeLimitChart.chartDimension",function(a,b){a!==b&&g("timeLimitChart")}),a.$watch("amountChart.menuData.index",function(a,b){a!==b&&g("amountChart")}),a.$watch("amountChart.chartDimension",function(a,b){a!==b&&g("amountChart")}),a.$watch("pledgeChart.menuData.index",function(a,b){a!==b&&g("pledgeChart")}),a.$watch("pledgeChart.chartDimension",function(a,b){a!==b&&g("pledgeChart")});var j={};h()}])}();