!function(){"use strict";angular.module("kt.lode").controller("ktAssetFeatureCtrl",["$scope","$location","$stateParams","ktProjectStaticsReportService","ktDateHelper",function(a,b,c,d,e){function f(){var b=a.data,c=b.dimensions;_.each(c,function(c){var d=_.find(a.charts,function(a){return a.key===c.key});d||(d={key:c.key,name:c.name,description:c.description,radioDataShowType:"table",chartDimension:"时点余额",chartOptions:{},list:[],menuData:{index:0,value:"absolute"},menuDataChange:function(){this.updateData()},dimentionChange:function(a){this.chartDimension=a,this.updateData()},updateData:function(){var a,c,d;a="时点余额"===this.chartDimension?"mature_prncp_balns_by_":"loan_amnt_incrmnt_by_",c="absolute"===this.menuData.value?"":"_percent",d=a+this.key+c;var e="_percent"===c?{tooltip:{yAxisFormat:"percent"},yAxis:{max:1,min:0}}:{tooltip:{yAxisFormat:"rmb"},yAxis:{max:null}};this.list=b[d],this.chartOptions=$.extend(!0,{},e,{legend:{data:_.map(b[d],"name")},xAxis:{type:"category",data:b.dates},series:_.map(b[d],function(a){return a.type="bar",a.stack="堆积组",a.barWidth=40,a})})}},d.updateData(),a.charts.push(d))})}function g(){var b,e,g;g=a.radioPeriod,g=g.split("~"),b=g[0]||null,e=g[1],d.get($.extend({projectID:c.projectID,type:"loan",dimention:"distribution",start_date:b,end_date:e},h),function(b){a.data=b,f()})}var h=b.search()||{};e.initPeriod(a,h),a.$watch("radioPeriod",function(a,c){if(a!==c&&"custom"!==a){var d=a.split("~");b.search($.extend(h,{start_date:d[0]||null,end_date:d[1]||null}))}}),a.charts=[],g()}])}();